import { products } from './data.js'; function generateProducts(){ const container = document.getElementById('productList') || document.createElement('div'); container.id = 'productList'; if(!document.getElementById('productList')) { const main = document.querySelector('main') || document.body; main.appendChild(container); } container.innerHTML = ''; products.forEach(item => { const html = ` <article class="card"> <img src="${item.image}" alt="${item.title}"> <h3>${item.title}</h3> <p>${item.description}</p> <p>Price: ${item.price}</p> <p>Rating: ${item.rating}</p> <button class="open-modal" data-id="${item.id}">Details</button> <button class="add-cart" data-id="${item.id}">Add to cart</button> </article> `; container.insertAdjacentHTML('beforeend', html); }); document.querySelectorAll('.open-modal').forEach(btn=>{ btn.addEventListener('click', (e)=>{ const id = Number(e.currentTarget.dataset.id); const item = products.find(p=>p.id===id); const dlg = document.getElementById('myModal'); dlg.querySelector('#lbl').textContent = item.title; dlg.querySelector('#desc').textContent = item.description + ' Price: ' + item.price; if (typeof dlg.showModal === 'function') dlg.showModal(); else dlg.classList.add('open'); }); }); document.querySelectorAll('.add-cart').forEach(btn=>{ btn.addEventListener('click', (e)=>{ const id = e.currentTarget.dataset.id; let cart = JSON.parse(localStorage.getItem('cart')||'{}'); cart[id] = (cart[id]||0)+1; localStorage.setItem('cart', JSON.stringify(cart)); updateCartCount(); }); }); } function updateCartCount(){ const cart = JSON.parse(localStorage.getItem('cart')||'{}'); const total = Object.values(cart).reduce((a,b)=>a+b,0); const el = document.getElementById('cartCount') || (() => { const span = document.createElement('span'); span.id='cartCount'; const nav = document.querySelector('.nav'); if(nav) nav.appendChild(span); return span; })(); el.textContent = total>0?`Cart: ${total}`:''; } const btn = document.getElementById('menuToggle'); const nav = document.getElementById('mainNav'); if(btn && nav){ btn.addEventListener('click', ()=>{ const expanded = btn.getAttribute('aria-expanded') === 'true'; btn.setAttribute('aria-expanded', String(!expanded)); nav.classList.toggle('open'); }); } document.addEventListener('click', (e)=>{ if(e.target && e.target.id==='closeModal') { const dlg = document.getElementById('myModal'); if (typeof dlg.close === 'function') dlg.close(); else dlg.classList.remove('open'); } }); async function fetchDemo(){ try{ const resp = await fetch('products.json'); if(!resp.ok) throw new Error('no local json'); const data = await resp.json(); console.log('Fetched local products.json fallback', data); }catch(err){ console.log('Fetch demo fallback, using exported products', err); } } document.addEventListener('DOMContentLoaded', ()=>{ generateProducts(); updateCartCount(); fetchDemo(); });